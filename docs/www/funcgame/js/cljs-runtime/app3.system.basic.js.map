{"version":3,"sources":["app3/system/basic.cljs"],"mappings":"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","names":["model","event","pred__36130","cljs.core/=","expr__36131","cljs.core/first","G__36133","G__36134","vec__36135","cljs.core/rest","app3.system.basic/moveSystem","entities","origin","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","cljs.core.partial.cljs$core$IFn$_invoke$arity$2","app3.tool/checkProperty","next","cljs.core.map.cljs$core$IFn$_invoke$arity$2","p__36138","map__36139","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","entity","cljs.core.get.cljs$core$IFn$_invoke$arity$2","cljs.core.update.cljs$core$IFn$_invoke$arity$3","cljs.core/replace","cljs.core/zipmap","_","vel","cljs.core.partial.cljs$core$IFn$_invoke$arity$3","cljs.core/map","cljs.core/+","app3.system.basic/boundPosition","p__36141","map__36142","vec__36143","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","x","y","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","x__4219__auto__","y__4220__auto__","x__4222__auto__","y__4223__auto__","app3.system.basic/resetPlayerVelocity","p__36147","map__36148","_2","app3.system.basic/resetEnemyVelocity","p__36150","map__36151","pred__36153","expr__36154","G__36156","G__36157","vec__36158","app3.system.basic/moveCostSystem","p__36161","map__36162","hp","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","len","app3.tool/length","app3.emitter/send","pred__36164","expr__36165","G__36167","G__36168","vec__36169","app3.system.basic/dieSystem","p__36172","map__36173","app3.weapon.fist/fist","pred__36175","expr__36176","G__36178","G__36179","vec__36180","G__36188","G__36189","vec__36190","app3.system.basic/roundSystem","cljs.core/inc","isPlayer","tag","plyr","enemy","nextPlyr","nextEnemy","cljs.core/constantly"],"sourcesContent":["(ns app3.system.basic\r\n  (:require [app3.weapon.fist])\r\n  (:require-macros [app3.macros :as m]))\r\n\r\n\r\n(m/defsys moveSystem\r\n  :update []\r\n  (m/docom {_ :position vel :velocity}\r\n           (update entity :position (partial map + vel))))\r\n\r\n\r\n(defn boundPosition [model entity]\r\n  (m/docom {[x y] :position}\r\n           (merge entity {:position [(-> x (max 0) (min 600)) (-> y (max 0) (min 600))]})))\r\n\r\n\r\n(defn resetPlayerVelocity [model entity]\r\n  (m/docom {_ :player _2 :velocity}\r\n           (merge entity {:velocity [0 0]})))\r\n\r\n\r\n(defn resetEnemyVelocity [model entity]\r\n  (m/docom {_ :enemy _2 :velocity}\r\n           (merge entity {:velocity [0 0]})))\r\n\r\n\r\n(m/defsys moveCostSystem\r\n  :update []\r\n  (m/docom {vel :velocity hp :hp}\r\n           (if (not (= [0 0] vel))\r\n             (let [len (app3.tool/length vel)]\r\n               (app3.emitter/send [:moveCost entity len] nil)\r\n               (merge entity {:hp (max 0 (- hp (/ len 10)))}))\r\n             entity)))\r\n\r\n\r\n(m/defsys dieSystem\r\n  :update []\r\n  (m/docom {hp :hp}\r\n           (if (<= hp 0)\r\n             (do \r\n               (app3.emitter/send [:died entity] nil)\r\n               (merge entity {:hp 100 :useWeapon app3.weapon.fist/fist}))\r\n             entity)))\r\n\r\n\r\n(m/defsys roundSystem\r\n  :update []\r\n  (update model :ticks inc)\r\n  \r\n  :died [entity]\r\n  (let [isPlayer (:player entity)\r\n        tag (if isPlayer :enemyWin :playerWin)\r\n        plyr (first (filter :player (:entities model)))\r\n        enemy (first (filter :enemy (:entities model)))\r\n        nextPlyr (merge plyr {:hp 100 :position [50 300]})\r\n        nextEnemy (merge enemy {:hp 100 :position [550 300]})]\r\n    (-> model\r\n        (update :ticks (constantly 0))\r\n        (update tag inc)\r\n        (update :round inc)\r\n        (update :entities (partial replace {plyr nextPlyr enemy nextEnemy})))))"]}